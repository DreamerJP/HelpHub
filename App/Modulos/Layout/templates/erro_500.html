{% extends "layout_base.html" %} {% block title %}Erro Interno - HelpHub 4.0{%
endblock %} {% block content %}
<div class="error-viewport error-500-page">
  <div class="error-scene">
    <div class="error-glass-card">
      <h1 class="error-huge-text glitch-500">Erro 500</h1>

      <div class="error-info">
        <h2 class="error-main-title">Sistema Indisponível</h2>
        <p class="error-sub-text">
          Ocorreu uma instabilidade interna em nossos servidores. <br />
          Por favor, <strong>avise o administrador</strong> para que possamos
          resolver o quanto antes.
        </p>
      </div>

      <div
        id="recovery-status"
        style="
          margin-top: 2rem;
          color: var(--text-muted);
          font-size: 0.95rem;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.75rem;
        "
      >
        <i class="ph ph-circle-notch ph-spin" style="color: var(--primary)"></i>
        <span>Tentando reconectar automaticamente...</span>
      </div>

      <script>
        // Função inteligente de auto-recuperação
        async function checkServer() {
          try {
            // Tenta dar um "ping" na raiz do site
            const response = await fetch("/", {
              method: "HEAD",
              cache: "no-store",
            });
            if (response.ok) {
              // Se o servidor respondeu 200 OK, recarrega a página original
              window.location.reload();
            }
          } catch (error) {
            // Servidor ainda fora do ar, continua tentando
            console.log("Servidor ainda indisponível...");
          }
        }

        // Tenta a cada 10 segundos
        setInterval(checkServer, 10000);
      </script>
    </div>
  </div>
</div>
{% endblock %}
