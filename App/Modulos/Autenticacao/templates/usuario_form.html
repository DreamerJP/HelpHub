{% extends "layout_base.html" %} {% from "componentes.html" import
render_layout_erp, erp_banner %} {% block title %}{{ titulo }} - HelpHub 4.0{%
endblock %} {% block page_title %}{{ titulo }}{% endblock %} {% block content %}
{# Toolbar: Único local para botões conforme padrão ERP #} {% set toolbar_html
%}
<div x-show="activeTab === 'membro'" x-cloak class="flex items-center gap-2">
  <button type="submit" form="form-usuario" class="erp-btn erp-btn-primary">
    <i class="ph ph-check-circle text-lg"></i> Salvar Usuário
  </button>
  <div class="erp-separator"></div>
  <a
    href="{{ url_for('auth.lista_usuarios') }}"
    class="erp-btn erp-btn-neutral"
  >
    <i class="ph ph-x-circle text-lg"></i> Cancelar
  </a>
</div>
{% endset %} {% call render_layout_erp( titulo="Membro da Equipe", abas=[{'id':
'membro', 'label': 'Dados do Usuário', 'icon': 'ph-user-circle-plus'}],
toolbar_buttons=toolbar_html, active_tab_id='membro' ) %}

<div style="padding: 2rem; min-height: 500px">
  <form
    method="POST"
    id="form-usuario"
    class="flex flex-col gap-10"
    style="max-width: 800px"
  >
    {{ form.hidden_tag() }} {% call erp_banner(tipo='info', titulo='Informação',
    icon='ph-shield-check') %} Defina as credenciais de acesso e o nível de
    permissão do usuário. {% endcall %}

    <section class="flex flex-col gap-6">
      <h4
        style="
          font-size: 0.75rem;
          text-transform: uppercase;
          color: var(--primary);
          font-weight: 800;
          border-bottom: 1px solid #e5e7eb;
          padding-bottom: 0.5rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        "
      >
        <i class="ph ph-identification-card"></i> Perfil de Acesso
      </h4>

      <div class="flex flex-col gap-1">
        <label class="font-semibold text-gray-700 text-sm">Nome Completo</label>
        {{ form.nome(class="form-control", placeholder="Ex: João Silva") }} {%
        for error in form.nome.errors %}
        <span class="text-xs text-red-500 mt-1">{{ error }}</span>
        {% endfor %}
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem">
        <div class="flex flex-col gap-1">
          <label class="font-semibold text-gray-700 text-sm"
            >Usuário (Login)</label
          >
          {% set user_placeholder = "Ex: joao.atendimento" %} {{
          form.username(class="form-control", placeholder=user_placeholder) }}
          {% for error in form.username.errors %}
          <span class="text-xs text-red-500 mt-1">{{ error }}</span>
          {% endfor %}
        </div>
        <div class="flex flex-col gap-1">
          <label class="font-semibold text-gray-700 text-sm"
            >Cargo / Nível</label
          >
          {{ form.role() }} {% for error in form.role.errors %}
          <span class="text-xs text-red-500 mt-1">{{ error }}</span>
          {% endfor %}
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem">
        <div class="flex flex-col gap-1">
          <label class="font-semibold text-gray-700 text-sm"
            >E-mail Corporativo</label
          >
          {{ form.email(class="form-control", placeholder="joao@empresa.com") }}
          {% for error in form.email.errors %}
          <span class="text-xs text-red-500 mt-1">{{ error }}</span>
          {% endfor %}
        </div>
        <div class="flex flex-col gap-1">
          <label class="font-semibold text-gray-700 text-sm">
            Senha de Acesso {% if 'Editar' in titulo %}
            <span class="font-normal text-gray-400 text-xs"
              >(Deixe vazio para manter)</span
            >
            {% else %}
            <span class="font-normal text-red-400 text-xs">(Obrigatório)</span>
            {% endif %}
          </label>
          {{ form.password(class="form-control", type="password",
          placeholder="******") }} {% for error in form.password.errors %}
          <span class="text-xs text-red-500 mt-1">{{ error }}</span>
          {% endfor %}
        </div>
      </div>

      <div
        class="flex items-center gap-2 mt-4 p-4 bg-gray-50 rounded-lg border border-gray-100"
      >
        {{ form.ativo(class="form-checkbox h-4 w-4 text-primary rounded
        border-gray-300") }}
        <label class="font-semibold text-gray-700 text-sm cursor-pointer"
          >Usuário Ativo e com Permissão de Login</label
        >
      </div>
    </section>
  </form>
</div>
{% endcall %} {% endblock %} {% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (document.getElementById("role")) {
      new TomSelect("#role", { create: false, allowEmptyOption: false });
    }
  });
</script>
{% endblock %}
